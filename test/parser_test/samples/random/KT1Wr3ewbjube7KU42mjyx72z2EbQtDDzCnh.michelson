parameter (or (nat %buy_nft) (or (nat %cancel_swap) (nat %swap_nft))); storage address; code { UNPAIR ; IF_LEFT { NIL operation ; DUP 3 ; CONTRACT %collect (pair nat nat) ; IF_NONE { PUSH int 16 ; FAILWITH } {} ; PUSH mutez 0 ; DIG 3 ; PUSH nat 1 ; PAIR ; TRANSFER_TOKENS ; CONS } { IF_LEFT { NIL operation ; DUP 3 ; CONTRACT %cancel_swap nat ; IF_NONE { PUSH int 26 ; FAILWITH } {} ; PUSH mutez 0 ; DIG 3 ; TRANSFER_TOKENS ; CONS } { NIL operation ; DUP 3 ; CONTRACT %swap (pair nat (pair nat mutez)) ; IF_NONE { PUSH int 21 ; FAILWITH } {} ; PUSH mutez 0 ; PUSH mutez 100000 ; DIG 4 ; PAIR ; PUSH nat 1 ; PAIR ; TRANSFER_TOKENS ; CONS } } ; PAIR }