parameter (or (key_hash %register) (key_hash %validate)); storage (big_map key_hash bool); code { LAMBDA (pair key_hash (big_map key_hash bool)) (pair (list operation) (big_map key_hash bool)) { UNPAIR ; SWAP ; PUSH bool True ; DUP 3 ; SWAP ; SOME ; SWAP ; UPDATE ; NIL operation ; DIG 2 ; SOME ; SET_DELEGATE ; CONS ; PAIR } ; SWAP ; UNPAIR ; IF_LEFT { PAIR ; EXEC } { SWAP ; DUP ; DUG 2 ; SWAP ; DUP ; DUG 2 ; GET ; IF_NONE { PAIR ; EXEC } { SWAP ; DIG 3 ; DROP 3 ; NIL operation ; PAIR } } }