parameter (or (string %delete) (pair %record (string %hash) (string %id))); storage (pair (big_map %hashes string string) (address %owner)); code { UNPAIR ; IF_LEFT { SENDER ; DUP 3 ; CDR ; COMPARE ; NEQ ; IF { PUSH string "Only the owner of the contract can delete a record." ; FAILWITH } {} ; PUSH bool False ; DUP 3 ; CAR ; DUP 3 ; MEM ; COMPARE ; EQ ; IF { PUSH string "Package-id is not known!" ; FAILWITH } {} ; SWAP ; DUP ; DUG 2 ; CDR ; DIG 2 ; CAR ; DIG 2 ; NONE string ; SWAP ; UPDATE ; PAIR ; NIL operation ; PAIR } { SENDER ; DUP 3 ; CDR ; COMPARE ; NEQ ; IF { PUSH string "Only the owner of the contract can add a new record." ; FAILWITH } {} ; SWAP ; DUP ; DUG 2 ; CDR ; DIG 2 ; CAR ; DUP 3 ; CAR ; SOME ; DIG 3 ; CDR ; UPDATE ; PAIR ; NIL operation ; PAIR } }